---
title: "Data Analysis"
execute:
  echo: true
  error: true 
author: "Fiona Norton"
format: 
  html: 
    code-fold: true
    code-summary: "Show code"
    theme: "simplex"
editor: visual
---

# Cleaning the data

```{r}
library(readr)
```

## Importing the data and using the R file provided by NLS for data cleaning

```{r, cleaning and importing}
#| message: false
new_data <- read_csv("DATA_NLSY97/NLSY97_SeniorProj.csv")
names(new_data) <- c('R0000100',
'R0536300',
'R0536401',
'R0536402',
'R1235800',
'R1302400',
'R1302500',
'R1302600',
'R1302700',
'R1482600',
'R3707300',
'R3707500',
'R3707800',
'U3314600',
'U3314700',
'U3314800',
'U3314900',
'U3315000',
'U3315100',
'U3315200',
'U3315300',
'U3315400',
'U3315500',
'U3315600',
'U3437900',
'U3438000',
'U3444000',
'U3444500',
'U3451500',
'U3455100',
'U4282300',
'U4328900',
'U4368000',
'U4370902')


# Handle missing values

new_data[new_data == -1] = NA  # Refused
new_data[new_data == -2] = NA  # Dont know
new_data[new_data == -3] = NA  # Invalid missing
new_data[new_data == -4] = NA  # Valid missing
new_data[new_data == -5] = NA  # Non-interview


# If there are values not categorized they will be represented as NA

vallabels = function(data) {
  data$R0536300 <- factor(data$R0536300,
levels=c(0.0,1.0,2.0),
labels=c("No Information",
"Male",
"Female"))
  data$R0536401 <- factor(data$R0536401,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0),
labels=c("1: January",
"2: February",
"3: March",
"4: April",
"5: May",
"6: June",
"7: July",
"8: August",
"9: September",
"10: October",
"11: November",
"12: December"))
  data$R1235800 <- factor(data$R1235800,
levels=c(0.0,1.0),
labels=c("Oversample",
"Cross-sectional"))
  data$R1302400 <- factor(data$R1302400,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YEAR COLLEGE",
"2ND YEAR COLLEGE",
"3RD YEAR COLLEGE",
"4TH YEAR COLLEGE",
"5TH YEAR COLLEGE",
"6TH YEAR COLLEGE",
"7TH YEAR COLLEGE",
"8TH YEAR COLLEGE OR MORE",
"UNGRADED"))
  data$R1302500 <- factor(data$R1302500,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YEAR COLLEGE",
"2ND YEAR COLLEGE",
"3RD YEAR COLLEGE",
"4TH YEAR COLLEGE",
"5TH YEAR COLLEGE",
"6TH YEAR COLLEGE",
"7TH YEAR COLLEGE",
"8TH YEAR COLLEGE OR MORE",
"UNGRADED"))
  data$R1302600 <- factor(data$R1302600,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YEAR COLLEGE",
"2ND YEAR COLLEGE",
"3RD YEAR COLLEGE",
"4TH YEAR COLLEGE",
"5TH YEAR COLLEGE",
"6TH YEAR COLLEGE",
"7TH YEAR COLLEGE",
"8TH YEAR COLLEGE OR MORE",
"UNGRADED"))
  data$R1302700 <- factor(data$R1302700,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YEAR COLLEGE",
"2ND YEAR COLLEGE",
"3RD YEAR COLLEGE",
"4TH YEAR COLLEGE",
"5TH YEAR COLLEGE",
"6TH YEAR COLLEGE",
"7TH YEAR COLLEGE",
"8TH YEAR COLLEGE OR MORE",
"UNGRADED"))
  data$R1482600 <- factor(data$R1482600,
levels=c(1.0,2.0,3.0,4.0),
labels=c("Black",
"Hispanic",
"Mixed Race (Non-Hispanic)",
"Non-Black / Non-Hispanic"))
  data$R3707800 <- factor(data$R3707800,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0),
labels=c("MOTHER (BIOLOGICAL OR ADOPTIVE) OF YOUTH",
"FATHER (BIOLOGICAL OR ADOPTIVE) OF YOUTH",
"STEP-MOTHER OR FEMALE SPOUSE/PARTNER OF YOUTH'S PARENT",
"STEP-FATHER OR MALE SPOUSE/PARTNER OF YOUTH'S PARENT",
"OTHER PARENT FIGURE (RELATIVE)",
"OTHER PARENT FIGURE (NON-RELATIVE)",
"DON'T KNOW RELATIONSHIP TO YOUTH",
"DON'T KNOW WHO COMPLETED THE FORM"))
  data$U3437900 <- factor(data$U3437900,
levels=c(33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0),
labels=c("33",
"34",
"35",
"36",
"37",
"38",
"39",
"40"))
  data$U3438000 <- factor(data$U3438000,
levels=c(1.0,2.0,3.0,4.0),
labels=c("Northeast (CT, ME, MA, NH, NJ, NY, PA, RI, VT)",
"North Central (IL, IN, IA, KS, MI, MN, MO, NE, OH, ND, SD, WI)",
"South (AL, AR, DE, DC, FL, GA, KY, LA, MD, MS, NC, OK, SC, TN , TX, VA, WV)",
"West (AK, AZ, CA, CO, HI, ID, MT, NV, NM, OR, UT, WA, WY)"))
  data$U3444500 <- factor(data$U3444500,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0),
labels=c("None",
"GED",
"High school diploma (Regular 12 year program)",
"Associate/Junior college (AA)",
"Bachelor's degree (BA, BS)",
"Master's degree (MA, MS)",
"PhD",
"Professional degree (DDS, JD, MD)"))
  data$U3451500 <- factor(data$U3451500,
levels=c(0.0,1.0,2.0,3.0,4.0),
labels=c("Never-married",
"Married",
"Separated",
"Divorced",
"Widowed"))
  data$U3455100 <- factor(data$U3455100,
levels=c(0.0,1.0,2.0),
labels=c("Not currently working at a job",
"Current working at a job",
"Military service (but no job) reported"))
  data$U4368000 <- factor(data$U4368000,
levels=c(1.0,2.0,3.0,4.0,5.0),
labels=c("Excellent",
"Very good",
"Good",
"Fair",
"Poor"))
  data$U4370902 <- factor(data$U4370902,
levels=c(0.0,1.0,2.0,3.0),
labels=c("Rarely/None of the time/1 Day",
"Some/A little of the time/1-2 Days",
"Occasionally/Moderate amount of the time/3-4 Days",
"Most/All of the time/ 5-7 Days"))
return(data)
}


# If there are values not categorized they will be represented as NA

vallabels_continuous = function(data) {
data$R0000100[1.0 <= data$R0000100 & data$R0000100 <= 999.0] <- 1.0
data$R0000100[1000.0 <= data$R0000100 & data$R0000100 <= 1999.0] <- 1000.0
data$R0000100[2000.0 <= data$R0000100 & data$R0000100 <= 2999.0] <- 2000.0
data$R0000100[3000.0 <= data$R0000100 & data$R0000100 <= 3999.0] <- 3000.0
data$R0000100[4000.0 <= data$R0000100 & data$R0000100 <= 4999.0] <- 4000.0
data$R0000100[5000.0 <= data$R0000100 & data$R0000100 <= 5999.0] <- 5000.0
data$R0000100[6000.0 <= data$R0000100 & data$R0000100 <= 6999.0] <- 6000.0
data$R0000100[7000.0 <= data$R0000100 & data$R0000100 <= 7999.0] <- 7000.0
data$R0000100[8000.0 <= data$R0000100 & data$R0000100 <= 8999.0] <- 8000.0
data$R0000100[9000.0 <= data$R0000100 & data$R0000100 <= 9999.0] <- 9000.0
data$R0000100 <- factor(data$R0000100,
levels=c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0),
labels=c("0",
"1 TO 999",
"1000 TO 1999",
"2000 TO 2999",
"3000 TO 3999",
"4000 TO 4999",
"5000 TO 5999",
"6000 TO 6999",
"7000 TO 7999",
"8000 TO 8999",
"9000 TO 9999"))
data$R3707300[1.0 <= data$R3707300 & data$R3707300 <= 4999.0] <- 1.0
data$R3707300[5000.0 <= data$R3707300 & data$R3707300 <= 9999.0] <- 5000.0
data$R3707300[10000.0 <= data$R3707300 & data$R3707300 <= 14999.0] <- 10000.0
data$R3707300[15000.0 <= data$R3707300 & data$R3707300 <= 19999.0] <- 15000.0
data$R3707300[20000.0 <= data$R3707300 & data$R3707300 <= 24999.0] <- 20000.0
data$R3707300[25000.0 <= data$R3707300 & data$R3707300 <= 29999.0] <- 25000.0
data$R3707300[30000.0 <= data$R3707300 & data$R3707300 <= 39999.0] <- 30000.0
data$R3707300[40000.0 <= data$R3707300 & data$R3707300 <= 49999.0] <- 40000.0
data$R3707300[50000.0 <= data$R3707300 & data$R3707300 <= 59999.0] <- 50000.0
data$R3707300[60000.0 <= data$R3707300 & data$R3707300 <= 69999.0] <- 60000.0
data$R3707300[70000.0 <= data$R3707300 & data$R3707300 <= 79999.0] <- 70000.0
data$R3707300[80000.0 <= data$R3707300 & data$R3707300 <= 89999.0] <- 80000.0
data$R3707300[90000.0 <= data$R3707300 & data$R3707300 <= 99999.0] <- 90000.0
data$R3707300[100000.0 <= data$R3707300 & data$R3707300 <= 149999.0] <- 100000.0
data$R3707300[150000.0 <= data$R3707300 & data$R3707300 <= 9.9999999E7] <- 150000.0
data$R3707300 <- factor(data$R3707300,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$R3707500[1.0 <= data$R3707500 & data$R3707500 <= 4999.0] <- 1.0
data$R3707500[5000.0 <= data$R3707500 & data$R3707500 <= 9999.0] <- 5000.0
data$R3707500[10000.0 <= data$R3707500 & data$R3707500 <= 14999.0] <- 10000.0
data$R3707500[15000.0 <= data$R3707500 & data$R3707500 <= 19999.0] <- 15000.0
data$R3707500[20000.0 <= data$R3707500 & data$R3707500 <= 24999.0] <- 20000.0
data$R3707500[25000.0 <= data$R3707500 & data$R3707500 <= 29999.0] <- 25000.0
data$R3707500[30000.0 <= data$R3707500 & data$R3707500 <= 39999.0] <- 30000.0
data$R3707500[40000.0 <= data$R3707500 & data$R3707500 <= 49999.0] <- 40000.0
data$R3707500[50000.0 <= data$R3707500 & data$R3707500 <= 59999.0] <- 50000.0
data$R3707500[60000.0 <= data$R3707500 & data$R3707500 <= 69999.0] <- 60000.0
data$R3707500[70000.0 <= data$R3707500 & data$R3707500 <= 79999.0] <- 70000.0
data$R3707500[80000.0 <= data$R3707500 & data$R3707500 <= 89999.0] <- 80000.0
data$R3707500[90000.0 <= data$R3707500 & data$R3707500 <= 99999.0] <- 90000.0
data$R3707500[100000.0 <= data$R3707500 & data$R3707500 <= 149999.0] <- 100000.0
data$R3707500[150000.0 <= data$R3707500 & data$R3707500 <= 9.9999999E7] <- 150000.0
data$R3707500 <- factor(data$R3707500,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$U3314600[170.0 <= data$U3314600 & data$U3314600 <= 290.0] <- 170.0
data$U3314600[370.0 <= data$U3314600 & data$U3314600 <= 490.0] <- 370.0
data$U3314600[570.0 <= data$U3314600 & data$U3314600 <= 690.0] <- 570.0
data$U3314600[1070.0 <= data$U3314600 & data$U3314600 <= 3990.0] <- 1070.0
data$U3314600[4070.0 <= data$U3314600 & data$U3314600 <= 4590.0] <- 4070.0
data$U3314600[4670.0 <= data$U3314600 & data$U3314600 <= 5790.0] <- 4670.0
data$U3314600[6070.0 <= data$U3314600 & data$U3314600 <= 6390.0] <- 6070.0
data$U3314600[6470.0 <= data$U3314600 & data$U3314600 <= 6780.0] <- 6470.0
data$U3314600[6870.0 <= data$U3314600 & data$U3314600 <= 7190.0] <- 6870.0
data$U3314600[7270.0 <= data$U3314600 & data$U3314600 <= 7790.0] <- 7270.0
data$U3314600[7860.0 <= data$U3314600 & data$U3314600 <= 8470.0] <- 7860.0
data$U3314600[8560.0 <= data$U3314600 & data$U3314600 <= 8690.0] <- 8560.0
data$U3314600[8770.0 <= data$U3314600 & data$U3314600 <= 9290.0] <- 8770.0
data$U3314600[9370.0 <= data$U3314600 & data$U3314600 <= 9590.0] <- 9370.0
data$U3314600[9670.0 <= data$U3314600 & data$U3314600 <= 9890.0] <- 9670.0
data$U3314600[9950.0 <= data$U3314600 & data$U3314600 <= 9990.0] <- 9950.0
data$U3314600 <- factor(data$U3314600,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3314700[170.0 <= data$U3314700 & data$U3314700 <= 290.0] <- 170.0
data$U3314700[370.0 <= data$U3314700 & data$U3314700 <= 490.0] <- 370.0
data$U3314700[570.0 <= data$U3314700 & data$U3314700 <= 690.0] <- 570.0
data$U3314700[1070.0 <= data$U3314700 & data$U3314700 <= 3990.0] <- 1070.0
data$U3314700[4070.0 <= data$U3314700 & data$U3314700 <= 4590.0] <- 4070.0
data$U3314700[4670.0 <= data$U3314700 & data$U3314700 <= 5790.0] <- 4670.0
data$U3314700[6070.0 <= data$U3314700 & data$U3314700 <= 6390.0] <- 6070.0
data$U3314700[6470.0 <= data$U3314700 & data$U3314700 <= 6780.0] <- 6470.0
data$U3314700[6870.0 <= data$U3314700 & data$U3314700 <= 7190.0] <- 6870.0
data$U3314700[7270.0 <= data$U3314700 & data$U3314700 <= 7790.0] <- 7270.0
data$U3314700[7860.0 <= data$U3314700 & data$U3314700 <= 8470.0] <- 7860.0
data$U3314700[8560.0 <= data$U3314700 & data$U3314700 <= 8690.0] <- 8560.0
data$U3314700[8770.0 <= data$U3314700 & data$U3314700 <= 9290.0] <- 8770.0
data$U3314700[9370.0 <= data$U3314700 & data$U3314700 <= 9590.0] <- 9370.0
data$U3314700[9670.0 <= data$U3314700 & data$U3314700 <= 9890.0] <- 9670.0
data$U3314700[9950.0 <= data$U3314700 & data$U3314700 <= 9990.0] <- 9950.0
data$U3314700 <- factor(data$U3314700,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3314800[170.0 <= data$U3314800 & data$U3314800 <= 290.0] <- 170.0
data$U3314800[370.0 <= data$U3314800 & data$U3314800 <= 490.0] <- 370.0
data$U3314800[570.0 <= data$U3314800 & data$U3314800 <= 690.0] <- 570.0
data$U3314800[1070.0 <= data$U3314800 & data$U3314800 <= 3990.0] <- 1070.0
data$U3314800[4070.0 <= data$U3314800 & data$U3314800 <= 4590.0] <- 4070.0
data$U3314800[4670.0 <= data$U3314800 & data$U3314800 <= 5790.0] <- 4670.0
data$U3314800[6070.0 <= data$U3314800 & data$U3314800 <= 6390.0] <- 6070.0
data$U3314800[6470.0 <= data$U3314800 & data$U3314800 <= 6780.0] <- 6470.0
data$U3314800[6870.0 <= data$U3314800 & data$U3314800 <= 7190.0] <- 6870.0
data$U3314800[7270.0 <= data$U3314800 & data$U3314800 <= 7790.0] <- 7270.0
data$U3314800[7860.0 <= data$U3314800 & data$U3314800 <= 8470.0] <- 7860.0
data$U3314800[8560.0 <= data$U3314800 & data$U3314800 <= 8690.0] <- 8560.0
data$U3314800[8770.0 <= data$U3314800 & data$U3314800 <= 9290.0] <- 8770.0
data$U3314800[9370.0 <= data$U3314800 & data$U3314800 <= 9590.0] <- 9370.0
data$U3314800[9670.0 <= data$U3314800 & data$U3314800 <= 9890.0] <- 9670.0
data$U3314800[9950.0 <= data$U3314800 & data$U3314800 <= 9990.0] <- 9950.0
data$U3314800 <- factor(data$U3314800,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3314900[170.0 <= data$U3314900 & data$U3314900 <= 290.0] <- 170.0
data$U3314900[370.0 <= data$U3314900 & data$U3314900 <= 490.0] <- 370.0
data$U3314900[570.0 <= data$U3314900 & data$U3314900 <= 690.0] <- 570.0
data$U3314900[1070.0 <= data$U3314900 & data$U3314900 <= 3990.0] <- 1070.0
data$U3314900[4070.0 <= data$U3314900 & data$U3314900 <= 4590.0] <- 4070.0
data$U3314900[4670.0 <= data$U3314900 & data$U3314900 <= 5790.0] <- 4670.0
data$U3314900[6070.0 <= data$U3314900 & data$U3314900 <= 6390.0] <- 6070.0
data$U3314900[6470.0 <= data$U3314900 & data$U3314900 <= 6780.0] <- 6470.0
data$U3314900[6870.0 <= data$U3314900 & data$U3314900 <= 7190.0] <- 6870.0
data$U3314900[7270.0 <= data$U3314900 & data$U3314900 <= 7790.0] <- 7270.0
data$U3314900[7860.0 <= data$U3314900 & data$U3314900 <= 8470.0] <- 7860.0
data$U3314900[8560.0 <= data$U3314900 & data$U3314900 <= 8690.0] <- 8560.0
data$U3314900[8770.0 <= data$U3314900 & data$U3314900 <= 9290.0] <- 8770.0
data$U3314900[9370.0 <= data$U3314900 & data$U3314900 <= 9590.0] <- 9370.0
data$U3314900[9670.0 <= data$U3314900 & data$U3314900 <= 9890.0] <- 9670.0
data$U3314900[9950.0 <= data$U3314900 & data$U3314900 <= 9990.0] <- 9950.0
data$U3314900 <- factor(data$U3314900,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315000[170.0 <= data$U3315000 & data$U3315000 <= 290.0] <- 170.0
data$U3315000[370.0 <= data$U3315000 & data$U3315000 <= 490.0] <- 370.0
data$U3315000[570.0 <= data$U3315000 & data$U3315000 <= 690.0] <- 570.0
data$U3315000[1070.0 <= data$U3315000 & data$U3315000 <= 3990.0] <- 1070.0
data$U3315000[4070.0 <= data$U3315000 & data$U3315000 <= 4590.0] <- 4070.0
data$U3315000[4670.0 <= data$U3315000 & data$U3315000 <= 5790.0] <- 4670.0
data$U3315000[6070.0 <= data$U3315000 & data$U3315000 <= 6390.0] <- 6070.0
data$U3315000[6470.0 <= data$U3315000 & data$U3315000 <= 6780.0] <- 6470.0
data$U3315000[6870.0 <= data$U3315000 & data$U3315000 <= 7190.0] <- 6870.0
data$U3315000[7270.0 <= data$U3315000 & data$U3315000 <= 7790.0] <- 7270.0
data$U3315000[7860.0 <= data$U3315000 & data$U3315000 <= 8470.0] <- 7860.0
data$U3315000[8560.0 <= data$U3315000 & data$U3315000 <= 8690.0] <- 8560.0
data$U3315000[8770.0 <= data$U3315000 & data$U3315000 <= 9290.0] <- 8770.0
data$U3315000[9370.0 <= data$U3315000 & data$U3315000 <= 9590.0] <- 9370.0
data$U3315000[9670.0 <= data$U3315000 & data$U3315000 <= 9890.0] <- 9670.0
data$U3315000[9950.0 <= data$U3315000 & data$U3315000 <= 9990.0] <- 9950.0
data$U3315000 <- factor(data$U3315000,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315100[170.0 <= data$U3315100 & data$U3315100 <= 290.0] <- 170.0
data$U3315100[370.0 <= data$U3315100 & data$U3315100 <= 490.0] <- 370.0
data$U3315100[570.0 <= data$U3315100 & data$U3315100 <= 690.0] <- 570.0
data$U3315100[1070.0 <= data$U3315100 & data$U3315100 <= 3990.0] <- 1070.0
data$U3315100[4070.0 <= data$U3315100 & data$U3315100 <= 4590.0] <- 4070.0
data$U3315100[4670.0 <= data$U3315100 & data$U3315100 <= 5790.0] <- 4670.0
data$U3315100[6070.0 <= data$U3315100 & data$U3315100 <= 6390.0] <- 6070.0
data$U3315100[6470.0 <= data$U3315100 & data$U3315100 <= 6780.0] <- 6470.0
data$U3315100[6870.0 <= data$U3315100 & data$U3315100 <= 7190.0] <- 6870.0
data$U3315100[7270.0 <= data$U3315100 & data$U3315100 <= 7790.0] <- 7270.0
data$U3315100[7860.0 <= data$U3315100 & data$U3315100 <= 8470.0] <- 7860.0
data$U3315100[8560.0 <= data$U3315100 & data$U3315100 <= 8690.0] <- 8560.0
data$U3315100[8770.0 <= data$U3315100 & data$U3315100 <= 9290.0] <- 8770.0
data$U3315100[9370.0 <= data$U3315100 & data$U3315100 <= 9590.0] <- 9370.0
data$U3315100[9670.0 <= data$U3315100 & data$U3315100 <= 9890.0] <- 9670.0
data$U3315100[9950.0 <= data$U3315100 & data$U3315100 <= 9990.0] <- 9950.0
data$U3315100 <- factor(data$U3315100,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315200[170.0 <= data$U3315200 & data$U3315200 <= 290.0] <- 170.0
data$U3315200[370.0 <= data$U3315200 & data$U3315200 <= 490.0] <- 370.0
data$U3315200[570.0 <= data$U3315200 & data$U3315200 <= 690.0] <- 570.0
data$U3315200[1070.0 <= data$U3315200 & data$U3315200 <= 3990.0] <- 1070.0
data$U3315200[4070.0 <= data$U3315200 & data$U3315200 <= 4590.0] <- 4070.0
data$U3315200[4670.0 <= data$U3315200 & data$U3315200 <= 5790.0] <- 4670.0
data$U3315200[6070.0 <= data$U3315200 & data$U3315200 <= 6390.0] <- 6070.0
data$U3315200[6470.0 <= data$U3315200 & data$U3315200 <= 6780.0] <- 6470.0
data$U3315200[6870.0 <= data$U3315200 & data$U3315200 <= 7190.0] <- 6870.0
data$U3315200[7270.0 <= data$U3315200 & data$U3315200 <= 7790.0] <- 7270.0
data$U3315200[7860.0 <= data$U3315200 & data$U3315200 <= 8470.0] <- 7860.0
data$U3315200[8560.0 <= data$U3315200 & data$U3315200 <= 8690.0] <- 8560.0
data$U3315200[8770.0 <= data$U3315200 & data$U3315200 <= 9290.0] <- 8770.0
data$U3315200[9370.0 <= data$U3315200 & data$U3315200 <= 9590.0] <- 9370.0
data$U3315200[9670.0 <= data$U3315200 & data$U3315200 <= 9890.0] <- 9670.0
data$U3315200[9950.0 <= data$U3315200 & data$U3315200 <= 9990.0] <- 9950.0
data$U3315200 <- factor(data$U3315200,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315300[170.0 <= data$U3315300 & data$U3315300 <= 290.0] <- 170.0
data$U3315300[370.0 <= data$U3315300 & data$U3315300 <= 490.0] <- 370.0
data$U3315300[570.0 <= data$U3315300 & data$U3315300 <= 690.0] <- 570.0
data$U3315300[1070.0 <= data$U3315300 & data$U3315300 <= 3990.0] <- 1070.0
data$U3315300[4070.0 <= data$U3315300 & data$U3315300 <= 4590.0] <- 4070.0
data$U3315300[4670.0 <= data$U3315300 & data$U3315300 <= 5790.0] <- 4670.0
data$U3315300[6070.0 <= data$U3315300 & data$U3315300 <= 6390.0] <- 6070.0
data$U3315300[6470.0 <= data$U3315300 & data$U3315300 <= 6780.0] <- 6470.0
data$U3315300[6870.0 <= data$U3315300 & data$U3315300 <= 7190.0] <- 6870.0
data$U3315300[7270.0 <= data$U3315300 & data$U3315300 <= 7790.0] <- 7270.0
data$U3315300[7860.0 <= data$U3315300 & data$U3315300 <= 8470.0] <- 7860.0
data$U3315300[8560.0 <= data$U3315300 & data$U3315300 <= 8690.0] <- 8560.0
data$U3315300[8770.0 <= data$U3315300 & data$U3315300 <= 9290.0] <- 8770.0
data$U3315300[9370.0 <= data$U3315300 & data$U3315300 <= 9590.0] <- 9370.0
data$U3315300[9670.0 <= data$U3315300 & data$U3315300 <= 9890.0] <- 9670.0
data$U3315300[9950.0 <= data$U3315300 & data$U3315300 <= 9990.0] <- 9950.0
data$U3315300 <- factor(data$U3315300,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315400[170.0 <= data$U3315400 & data$U3315400 <= 290.0] <- 170.0
data$U3315400[370.0 <= data$U3315400 & data$U3315400 <= 490.0] <- 370.0
data$U3315400[570.0 <= data$U3315400 & data$U3315400 <= 690.0] <- 570.0
data$U3315400[1070.0 <= data$U3315400 & data$U3315400 <= 3990.0] <- 1070.0
data$U3315400[4070.0 <= data$U3315400 & data$U3315400 <= 4590.0] <- 4070.0
data$U3315400[4670.0 <= data$U3315400 & data$U3315400 <= 5790.0] <- 4670.0
data$U3315400[6070.0 <= data$U3315400 & data$U3315400 <= 6390.0] <- 6070.0
data$U3315400[6470.0 <= data$U3315400 & data$U3315400 <= 6780.0] <- 6470.0
data$U3315400[6870.0 <= data$U3315400 & data$U3315400 <= 7190.0] <- 6870.0
data$U3315400[7270.0 <= data$U3315400 & data$U3315400 <= 7790.0] <- 7270.0
data$U3315400[7860.0 <= data$U3315400 & data$U3315400 <= 8470.0] <- 7860.0
data$U3315400[8560.0 <= data$U3315400 & data$U3315400 <= 8690.0] <- 8560.0
data$U3315400[8770.0 <= data$U3315400 & data$U3315400 <= 9290.0] <- 8770.0
data$U3315400[9370.0 <= data$U3315400 & data$U3315400 <= 9590.0] <- 9370.0
data$U3315400[9670.0 <= data$U3315400 & data$U3315400 <= 9890.0] <- 9670.0
data$U3315400[9950.0 <= data$U3315400 & data$U3315400 <= 9990.0] <- 9950.0
data$U3315400 <- factor(data$U3315400,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315500[170.0 <= data$U3315500 & data$U3315500 <= 290.0] <- 170.0
data$U3315500[370.0 <= data$U3315500 & data$U3315500 <= 490.0] <- 370.0
data$U3315500[570.0 <= data$U3315500 & data$U3315500 <= 690.0] <- 570.0
data$U3315500[1070.0 <= data$U3315500 & data$U3315500 <= 3990.0] <- 1070.0
data$U3315500[4070.0 <= data$U3315500 & data$U3315500 <= 4590.0] <- 4070.0
data$U3315500[4670.0 <= data$U3315500 & data$U3315500 <= 5790.0] <- 4670.0
data$U3315500[6070.0 <= data$U3315500 & data$U3315500 <= 6390.0] <- 6070.0
data$U3315500[6470.0 <= data$U3315500 & data$U3315500 <= 6780.0] <- 6470.0
data$U3315500[6870.0 <= data$U3315500 & data$U3315500 <= 7190.0] <- 6870.0
data$U3315500[7270.0 <= data$U3315500 & data$U3315500 <= 7790.0] <- 7270.0
data$U3315500[7860.0 <= data$U3315500 & data$U3315500 <= 8470.0] <- 7860.0
data$U3315500[8560.0 <= data$U3315500 & data$U3315500 <= 8690.0] <- 8560.0
data$U3315500[8770.0 <= data$U3315500 & data$U3315500 <= 9290.0] <- 8770.0
data$U3315500[9370.0 <= data$U3315500 & data$U3315500 <= 9590.0] <- 9370.0
data$U3315500[9670.0 <= data$U3315500 & data$U3315500 <= 9890.0] <- 9670.0
data$U3315500[9950.0 <= data$U3315500 & data$U3315500 <= 9990.0] <- 9950.0
data$U3315500 <- factor(data$U3315500,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3315600[170.0 <= data$U3315600 & data$U3315600 <= 290.0] <- 170.0
data$U3315600[370.0 <= data$U3315600 & data$U3315600 <= 490.0] <- 370.0
data$U3315600[570.0 <= data$U3315600 & data$U3315600 <= 690.0] <- 570.0
data$U3315600[1070.0 <= data$U3315600 & data$U3315600 <= 3990.0] <- 1070.0
data$U3315600[4070.0 <= data$U3315600 & data$U3315600 <= 4590.0] <- 4070.0
data$U3315600[4670.0 <= data$U3315600 & data$U3315600 <= 5790.0] <- 4670.0
data$U3315600[6070.0 <= data$U3315600 & data$U3315600 <= 6390.0] <- 6070.0
data$U3315600[6470.0 <= data$U3315600 & data$U3315600 <= 6780.0] <- 6470.0
data$U3315600[6870.0 <= data$U3315600 & data$U3315600 <= 7190.0] <- 6870.0
data$U3315600[7270.0 <= data$U3315600 & data$U3315600 <= 7790.0] <- 7270.0
data$U3315600[7860.0 <= data$U3315600 & data$U3315600 <= 8470.0] <- 7860.0
data$U3315600[8560.0 <= data$U3315600 & data$U3315600 <= 8690.0] <- 8560.0
data$U3315600[8770.0 <= data$U3315600 & data$U3315600 <= 9290.0] <- 8770.0
data$U3315600[9370.0 <= data$U3315600 & data$U3315600 <= 9590.0] <- 9370.0
data$U3315600[9670.0 <= data$U3315600 & data$U3315600 <= 9890.0] <- 9670.0
data$U3315600[9950.0 <= data$U3315600 & data$U3315600 <= 9990.0] <- 9950.0
data$U3315600 <- factor(data$U3315600,
levels=c(170.0,370.0,570.0,770.0,1070.0,4070.0,4670.0,5890.0,6070.0,6470.0,6870.0,7270.0,7860.0,8560.0,8770.0,9370.0,9670.0,9950.0),
labels=c("170 TO 290: AGRICULTURE, FORESTRY AND FISHERIES",
"370 TO 490: MINING",
"570 TO 690: UTILITIES",
"770: CONSTRUCTION",
"1070 TO 3990: MANUFACTURING",
"4070 TO 4590: WHOLESALE TRADE",
"4670 TO 5790: RETAIL TRADE",
"5890: ARTS, ENTERTAINMENT AND RECREATION SERVICES",
"6070 TO 6390: TRANSPORTATION AND WAREHOUSING",
"6470 TO 6780: INFORMATION AND COMMUNICATION",
"6870 TO 7190: FINANCE, INSURANCE, AND REAL ESTATE",
"7270 TO 7790: PROFESSIONAL AND RELATED SERVICES",
"7860 TO 8470: EDUCATIONAL, HEALTH, AND SOCIAL SERVICES",
"8560 TO 8690: ENTERTAINMENT, ACCOMODATIONS, AND FOOD SERVICES",
"8770 TO 9290: OTHER SERVICES",
"9370 TO 9590: PUBLIC ADMINISTRATION",
"9670 TO 9890: ACTIVE DUTY MILITARY",
"9950 TO 9990: ACS SPECIAL CODES"))
data$U3444000[-999999.0 <= data$U3444000 & data$U3444000 <= -3000.0] <- -999999.0
data$U3444000[-2999.0 <= data$U3444000 & data$U3444000 <= -2000.0] <- -2999.0
data$U3444000[-1999.0 <= data$U3444000 & data$U3444000 <= -1000.0] <- -1999.0
data$U3444000[-999.0 <= data$U3444000 & data$U3444000 <= -1.0] <- -999.0
data$U3444000[1.0 <= data$U3444000 & data$U3444000 <= 1000.0] <- 1.0
data$U3444000[1001.0 <= data$U3444000 & data$U3444000 <= 2000.0] <- 1001.0
data$U3444000[2001.0 <= data$U3444000 & data$U3444000 <= 3000.0] <- 2001.0
data$U3444000[3001.0 <= data$U3444000 & data$U3444000 <= 5000.0] <- 3001.0
data$U3444000[5001.0 <= data$U3444000 & data$U3444000 <= 10000.0] <- 5001.0
data$U3444000[10001.0 <= data$U3444000 & data$U3444000 <= 20000.0] <- 10001.0
data$U3444000[20001.0 <= data$U3444000 & data$U3444000 <= 30000.0] <- 20001.0
data$U3444000[30001.0 <= data$U3444000 & data$U3444000 <= 40000.0] <- 30001.0
data$U3444000[40001.0 <= data$U3444000 & data$U3444000 <= 50000.0] <- 40001.0
data$U3444000[50001.0 <= data$U3444000 & data$U3444000 <= 65000.0] <- 50001.0
data$U3444000[65001.0 <= data$U3444000 & data$U3444000 <= 80000.0] <- 65001.0
data$U3444000[80001.0 <= data$U3444000 & data$U3444000 <= 100000.0] <- 80001.0
data$U3444000[100001.0 <= data$U3444000 & data$U3444000 <= 150000.0] <- 100001.0
data$U3444000[150001.0 <= data$U3444000 & data$U3444000 <= 200000.0] <- 150001.0
data$U3444000[200001.0 <= data$U3444000 & data$U3444000 <= 999999.0] <- 200001.0
data$U3444000 <- factor(data$U3444000,
levels=c(-999999.0,-2999.0,-1999.0,-999.0,0.0,1.0,1001.0,2001.0,3001.0,5001.0,10001.0,20001.0,30001.0,40001.0,50001.0,65001.0,80001.0,100001.0,150001.0,200001.0),
labels=c("-999999 TO -3000: < -2999",
"-2999 TO -2000",
"-1999 TO -1000",
"-999 TO -1",
"0",
"1 TO 1000",
"1001 TO 2000",
"2001 TO 3000",
"3001 TO 5000",
"5001 TO 10000",
"10001 TO 20000",
"20001 TO 30000",
"30001 TO 40000",
"40001 TO 50000",
"50001 TO 65000",
"65001 TO 80000",
"80001 TO 100000",
"100001 TO 150000",
"150001 TO 200000",
"200001 TO 999999: 200001+"))
data$U4282300[1.0 <= data$U4282300 & data$U4282300 <= 4999.0] <- 1.0
data$U4282300[5000.0 <= data$U4282300 & data$U4282300 <= 9999.0] <- 5000.0
data$U4282300[10000.0 <= data$U4282300 & data$U4282300 <= 14999.0] <- 10000.0
data$U4282300[15000.0 <= data$U4282300 & data$U4282300 <= 19999.0] <- 15000.0
data$U4282300[20000.0 <= data$U4282300 & data$U4282300 <= 24999.0] <- 20000.0
data$U4282300[25000.0 <= data$U4282300 & data$U4282300 <= 29999.0] <- 25000.0
data$U4282300[30000.0 <= data$U4282300 & data$U4282300 <= 39999.0] <- 30000.0
data$U4282300[40000.0 <= data$U4282300 & data$U4282300 <= 49999.0] <- 40000.0
data$U4282300[50000.0 <= data$U4282300 & data$U4282300 <= 59999.0] <- 50000.0
data$U4282300[60000.0 <= data$U4282300 & data$U4282300 <= 69999.0] <- 60000.0
data$U4282300[70000.0 <= data$U4282300 & data$U4282300 <= 79999.0] <- 70000.0
data$U4282300[80000.0 <= data$U4282300 & data$U4282300 <= 89999.0] <- 80000.0
data$U4282300[90000.0 <= data$U4282300 & data$U4282300 <= 99999.0] <- 90000.0
data$U4282300[100000.0 <= data$U4282300 & data$U4282300 <= 149999.0] <- 100000.0
data$U4282300[150000.0 <= data$U4282300 & data$U4282300 <= 9.9999999E7] <- 150000.0
data$U4282300 <- factor(data$U4282300,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$U4328900[15.0 <= data$U4328900 & data$U4328900 <= 999.0] <- 15.0
data$U4328900 <- factor(data$U4328900,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0),
labels=c("0",
"1",
"2",
"3",
"4",
"5",
"6",
"7",
"8",
"9",
"10",
"11",
"12",
"13",
"14",
"15 TO 999: 15+"))
return(data)
}

varlabels <- c("PUBID - YTH ID CODE 1997",
"KEY!SEX (SYMBOL) 1997",
"KEY!BDATE M/Y (SYMBOL) 1997",
"KEY!BDATE M/Y (SYMBOL) 1997",
"CV_SAMPLE_TYPE 1997",
"CV_HGC_BIO_DAD 1997",
"CV_HGC_BIO_MOM 1997",
"CV_HGC_RES_DAD 1997",
"CV_HGC_RES_MOM 1997",
"KEY!RACE_ETHNICITY (SYMBOL) 1997",
"AMT PARS OWN IN 1998 1999",
"AMT PARS SP/PART INC 1998 1999",
"REL OF HIU R TO YOUTH 1999",
"YEMP IND CODE (ROS ITEM) L1 2019",
"YEMP IND CODE (ROS ITEM) L2 2019",
"YEMP IND CODE (ROS ITEM) L3 2019",
"YEMP IND CODE (ROS ITEM) L4 2019",
"YEMP IND CODE (ROS ITEM) L5 2019",
"YEMP IND CODE (ROS ITEM) L6 2019",
"YEMP IND CODE (ROS ITEM) L7 2019",
"YEMP IND CODE (ROS ITEM) L8 2019",
"YEMP IND CODE (ROS ITEM) L9 2019",
"YEMP IND CODE (ROS ITEM) L10 2019",
"YEMP IND CODE (ROS ITEM) L11 2019",
"CV_AGE_INT_DATE 2019",
"CV_CENSUS_REGION 2019",
"CV_INCOME_FAMILY 2019",
"CV_HIGHEST_DEGREE_EVER 2019",
"CV_MARSTAT_COLLAPSED 2019",
"DATE OF INTERVIEW STATUS - EMPLOYED 2019",
"TTL INC WAGES, SALARY PAST YR 2019",
"TTL # TIMES ARRESTED SDLI 2019",
"HOW R'S GENERAL HEALTH? 2019",
"CESD - DEPRESSION 2019"
)


# Use qnames rather than rnums

qnames = function(data) {
names(data) <- c("PUBID_1997",
"KEY_SEX_1997",
"KEY_BDATE_M_1997",
"KEY_BDATE_Y_1997",
"CV_SAMPLE_TYPE_1997",
"CV_HGC_BIO_DAD_1997",
"CV_HGC_BIO_MOM_1997",
"CV_HGC_RES_DAD_1997",
"CV_HGC_RES_MOM_1997",
"KEY_RACE_ETHNICITY_1997",
"HIU-2_1999",
"HIU-4_1999",
"HIU-8_1999",
"YEMP_INDCODE-2002.01_2019",
"YEMP_INDCODE-2002.02_2019",
"YEMP_INDCODE-2002.03_2019",
"YEMP_INDCODE-2002.04_2019",
"YEMP_INDCODE-2002.05_2019",
"YEMP_INDCODE-2002.06_2019",
"YEMP_INDCODE-2002.07_2019",
"YEMP_INDCODE-2002.08_2019",
"YEMP_INDCODE-2002.09_2019",
"YEMP_INDCODE-2002.10_2019",
"YEMP_INDCODE-2002.11_2019",
"CV_AGE_INT_DATE_2019",
"CV_CENSUS_REGION_2019",
"CV_INCOME_FAMILY_2019",
"CV_HIGHEST_DEGREE_EVER_EDT_2019",
"CV_MARSTAT_COLLAPSED_2019",
"CV_DOI_EMPLOYED_2019",
"YINC-1700_2019",
"YSAQF-443_2019",
"YHEA-100_2019",
"YHEA-CESD-1A~000003_2019")
return(data)
}

# Remove the '#' before the following line to create a data file called "categories" with value labels.
categories <- vallabels(new_data)

# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
new_data <- qnames(new_data)
categories <- qnames(categories)

NLSY97 <- new_data
```

## My data cleaning

```{r, libraries}
#| message: false
library(tidyverse)
library(tidyselect)
```

### Renaming the variables:

```{r}
NLSY97 <- NLSY97|> 
  rename("RespondantID" = PUBID_1997,
         "Sex" = KEY_SEX_1997, 
         "BD_Month" = KEY_BDATE_M_1997,
         "BD_Year" = KEY_BDATE_Y_1997,
         "Race_Ethnicity" = KEY_RACE_ETHNICITY_1997,
         "HGA_Dad" = CV_HGC_BIO_DAD_1997,
         "HGA_Mom" = CV_HGC_BIO_MOM_1997,
         "SampleType" = CV_SAMPLE_TYPE_1997,
         "ResponseParent_Income" = `HIU-2_1999`,
         "NonResponseParent_Income" = `HIU-4_1999`,
         "ResponseParent_Relation" = `HIU-8_1999`,
         "Age" = CV_AGE_INT_DATE_2019,
         "Region" = CV_CENSUS_REGION_2019,
         "FamilyIncome" = CV_INCOME_FAMILY_2019,
         "HighestDegree" = CV_HIGHEST_DEGREE_EVER_EDT_2019,
         "MaritalStatus" = CV_MARSTAT_COLLAPSED_2019,
         "EmploymentStatus" = CV_DOI_EMPLOYED_2019,
         "YearIncome" = `YINC-1700_2019`,
         "Arrests_SLI" = `YSAQF-443_2019`,
         "GeneralHealth" = `YHEA-100_2019`,
         "Depression" = `YHEA-CESD-1A~000003_2019`)
```

### Selecting the best variables:

```{r}
NLSY97 <- NLSY97|> 
  select("RespondantID",
         "Sex", 
         "BD_Month",
         "BD_Year",
         "Race_Ethnicity",
         "HGA_Dad",
         "HGA_Mom",
         "SampleType",
         "ResponseParent_Income",
         "NonResponseParent_Income",
         "ResponseParent_Relation",
         "Age",
         "Region",
         "FamilyIncome",
         "HighestDegree",
         "MaritalStatus",
         "EmploymentStatus",
         "YearIncome",
         "Arrests_SLI",
         "GeneralHealth",
         "Depression")
```

### Removing subjects without response parent gender ID or income

```{r}
NLSY97 <- NLSY97 |> 
  filter(ResponseParent_Relation != 5,
         ResponseParent_Relation != 6,
         ResponseParent_Relation != 7,
         ResponseParent_Relation != 8, 
         na.rm = TRUE)
```

```{r}
NLSY97 <- NLSY97 |> 
  filter(!is.na(ResponseParent_Income))
```

```{r}
NLSY97 <- NLSY97 |> 
  filter(!is.na(NonResponseParent_Income)) |> 
  filter(ResponseParent_Income != NonResponseParent_Income)
```

### Adding "Breadwinner" variable

```{r}
NLSY97 <- NLSY97 |> 
  mutate(Breadwinner = case_when(ResponseParent_Income > NonResponseParent_Income &
                                   ResponseParent_Relation == 1 ~ "Female Breadwinner", 
                                 ResponseParent_Income < NonResponseParent_Income &
                                   ResponseParent_Relation == 1 ~ "Male Breadwinner",
                                 ResponseParent_Income > NonResponseParent_Income & 
                                   ResponseParent_Relation == 2  ~ "Male Breadwinner",
                                 ResponseParent_Income < NonResponseParent_Income & 
                                   ResponseParent_Relation == 2  ~ "Female Breadwinner",
                                 ResponseParent_Income > NonResponseParent_Income &
                                   ResponseParent_Relation == 3 ~ "Female Breadwinner", 
                                 ResponseParent_Income < NonResponseParent_Income &
                                   ResponseParent_Relation == 3 ~ "Male Breadwinner",
                                 ResponseParent_Income > NonResponseParent_Income & 
                                   ResponseParent_Relation == 4  ~ "Male Breadwinner",
                                 ResponseParent_Income < NonResponseParent_Income & 
                                   ResponseParent_Relation == 4  ~ "Female Breadwinner"
                                 ))
```

```{r}
NLSY97 <- NLSY97 |> 
  mutate(Breadwinner = case_when(Breadwinner == "Female Breadwinner" ~0,
                                 Breadwinner == "Male Breadwinner" ~1))
```

### Adding a variable for first time period income (childhood household income)

```{r}
NLSY97 <- NLSY97 |> 
  mutate("Time1_Income" = ResponseParent_Income + NonResponseParent_Income)
```

```{r}
write_csv(NLSY97, "NLSY97_cleaner.csv")
```

### Making factor variables

```{r}
NLSY97 <- NLSY97 |> 
  mutate(Race_Ethnicity = as.factor(Race_Ethnicity),
         Region = as.factor(Region),
         Sex = as.factor(Sex),
         HighestDegree = as.factor(HighestDegree))
```

# Pre-analysis using non-matched data

```{r}
library(MatchIt)
library(dplyr)
library(ggplot2)
```

## Difference in means: outcome variable

```{r}
NLSY97 |> 
  group_by(Breadwinner) |> 
  summarise(n_subjects = n(),
            mean_income = mean(YearIncome, na.rm = TRUE),
            std_error = sd(YearIncome, na.rm = TRUE) / sqrt(n_subjects))
```

## Difference in means: pretreatment covariates

```{r}
NLSY97_cov <- c('HGA_Dad', 'HGA_Mom', 'Age', 'Depression')
NLSY97 |> 
  group_by(Breadwinner) |> 
  select(one_of(NLSY97_cov)) |> 
  summarise_all(funs(mean(., na.rm = TRUE)))
```

## Pre-Analysis Plots

```{r}
#| warning: false
NLSY97 |> 
  mutate(HighestDegree = as.factor(HighestDegree)) |> 
  mutate(Breadwinner = case_when(Breadwinner == 0 ~ "Female", 
                                 Breadwinner == 1 ~ "Male")) |> 
  ggplot(mapping = aes(x = HighestDegree, y = YearIncome, color = HighestDegree)) +
  facet_wrap(~Breadwinner) +
  geom_jitter() +
  labs(title = "Income by Degree Level for Participants with a Male vs. Female Breadwinner", x = "Highest Degree Received", y = "Income ($)") +
  theme(legend.position = "none")
```

# OLS Models

## OLS predicting income with all covariates

```{r}
Full_OLS_model = lm(NLSY97$YearIncome ~ NLSY97$Sex + NLSY97$Race_Ethnicity + NLSY97$HGA_Dad + NLSY97$HGA_Mom + NLSY97$ResponseParent_Income + NLSY97$NonResponseParent_Income + NLSY97$Age + NLSY97$Region + NLSY97$HighestDegree + NLSY97$Depression + NLSY97$Breadwinner)

summary(Full_OLS_model)
```

## OLS predicting income with all covariates (EXCLUDING HDE)

```{r}
Fullish_OLS = lm(NLSY97$YearIncome ~ NLSY97$Sex + NLSY97$Race_Ethnicity + NLSY97$HGA_Dad + NLSY97$HGA_Mom + NLSY97$ResponseParent_Income + NLSY97$NonResponseParent_Income + NLSY97$Age + NLSY97$Region + NLSY97$Depression + NLSY97$Breadwinner)

summary(Fullish_OLS)
```

## OLS predicting income with all covariates for females

```{r}
NLSY97_female <- NLSY97 |> 
  filter(Sex == 2)
```

```{r}
Female_OLS_model = lm(NLSY97_female$YearIncome ~ NLSY97_female$Race_Ethnicity + NLSY97_female$HGA_Dad + NLSY97_female$HGA_Mom + NLSY97_female$ResponseParent_Income + NLSY97_female$NonResponseParent_Income + NLSY97_female$Age + NLSY97_female$Region + NLSY97_female$HighestDegree + NLSY97_female$Depression + NLSY97_female$Breadwinner)
summary(Female_OLS_model)
```

### Investigating relationship between gender of breadwinner and reported depression

```{r}
NLSY97 |>  
  mutate(Depression = as.factor(Depression)) |> 
  mutate(Breadwinner = case_when(Breadwinner == 0 ~ "Female", 
                                 Breadwinner == 1 ~ "Male")) |> 
  ggplot(mapping = aes(x = Breadwinner, fill = Depression)) +
  geom_bar(position = position_fill(reverse = TRUE)) +
  labs(title = "Reported Depression Level for Subjects With Male vs. Female Breadwinner", x = "Breadwinner Gender", y = "Proportion of Sample Population")
```

Note: Depression scale = 0 "Rarely/None of the time/1 Day" 1 "Some/A little of the time/1-2 Days" 2 "Occasionally/Moderate amount of the time/3-4 Days" 3 "Most/All of the time/ 5-7 Days"

## OLS predicting income with all covariates for females (EXCLUDING HDE)

```{r, female model without including participant education}
Female_OLS2 = lm(NLSY97_female$YearIncome ~ NLSY97_female$Race_Ethnicity + NLSY97_female$HGA_Dad + NLSY97_female$HGA_Mom + NLSY97_female$ResponseParent_Income + NLSY97_female$NonResponseParent_Income + NLSY97_female$Age + NLSY97_female$Region + NLSY97_female$Depression + NLSY97_female$Breadwinner)

summary(Female_OLS2)
```

## OLS predicting income with all covariates for males

```{r}
NLSY97_male <- NLSY97 |> 
  filter(Sex == 1)
```

```{r}
Male_OLS_model = lm(NLSY97_male$YearIncome ~ NLSY97_male$Race_Ethnicity + NLSY97_male$HGA_Dad + NLSY97_male$HGA_Mom + NLSY97_male$ResponseParent_Income + NLSY97_male$NonResponseParent_Income + NLSY97_male$Age + NLSY97_male$Region + NLSY97_male$HighestDegree + NLSY97_male$Depression + NLSY97_male$Breadwinner)

summary(Male_OLS_model)
```

## OLS predicting income with all covariates for males (EXCLUDING HDE)

```{r}
Male_OLS2 = lm(NLSY97_male$YearIncome ~ NLSY97_male$Race_Ethnicity + NLSY97_male$HGA_Dad + NLSY97_male$HGA_Mom + NLSY97_male$ResponseParent_Income + NLSY97_male$NonResponseParent_Income + NLSY97_male$Age + NLSY97_male$Region + NLSY97_male$Depression + NLSY97_male$Breadwinner)

summary(Male_OLS2)
```

## OLS predicting income with all covariates for subject with at least a Bachelor's degree (BA, BS)

```{r}
NLSY97_BA <- NLSY97 |> 
  filter(HighestDegree == "4" |
         HighestDegree == "5" |
         HighestDegree == "6" |
         HighestDegree == "7")
```

```{r}
BA_OLS_model = lm(NLSY97_BA$YearIncome ~ NLSY97_BA$Sex + NLSY97_BA$Race_Ethnicity + NLSY97_BA$HGA_Dad + NLSY97_BA$HGA_Mom + NLSY97_BA$ResponseParent_Income + NLSY97_BA$NonResponseParent_Income + NLSY97_BA$Age + NLSY97_BA$Region + NLSY97_BA$Depression + NLSY97_BA$Breadwinner)

summary(BA_OLS_model)
```

## OLS predicting income with all covariates for subject with at least a Bachelor's degree (BA, BS)

```{r}
BA_OLS2 = lm(NLSY97_BA$YearIncome ~ NLSY97_BA$Sex + NLSY97_BA$Race_Ethnicity + NLSY97_BA$HGA_Dad + NLSY97_BA$HGA_Mom + NLSY97_BA$ResponseParent_Income + NLSY97_BA$NonResponseParent_Income + NLSY97_BA$Age + NLSY97_BA$Region + NLSY97_BA$Depression + NLSY97_BA$Breadwinner)

summary(BA_OLS2)
```

## OLS predicting income with all covariates for subject with high school diploma

```{r}
NLSY97_HS <- NLSY97 |> 
  filter(HighestDegree == 2)
```

```{r}
HS_OLS_model = lm(NLSY97_HS$YearIncome ~ NLSY97_HS$Sex + NLSY97_HS$Race_Ethnicity + NLSY97_HS$HGA_Dad + NLSY97_HS$HGA_Mom + NLSY97_HS$ResponseParent_Income + NLSY97_HS$NonResponseParent_Income + NLSY97_HS$Age + NLSY97_HS$Region + NLSY97_HS$Depression + NLSY97_HS$Breadwinner)
summary(HS_OLS_model)
```
